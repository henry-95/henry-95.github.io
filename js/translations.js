const glossary = {
    nav: {
        about: { en: "About", de: "Über Mich", es: "Sobre Mí" },
        services: { en: "Services", de: "Dienstleistungen", es: "Servicios" },
        membership: { en: "Membership", de: "Mitgliedschaft", es: "Membresía" },
        portfolio: { en: "Portfolio", de: "Portfolio", es: "Portafolio" },
        contact: { en: "Contact Me", de: "Kontakt", es: "Contacto" }
    },
    hero: {
        subtitle: { en: "Dedicated Web Partner for Equestrians", de: "Ihr engagierter Web-Partner für den Reitsport", es: "Su Socio Web Dedicado para el Mundo Ecuestre" },
        title_prefix: { en: "Elevate Your", de: "Stärken Sie Ihr", es: "Eleva Tu" },
        title_highlight: { en: "Equine Business", de: "Pferdegeschäft", es: "Negocio Equino" },
        description: {
            en: "I provide complete peace of mind for your equine business. I ensure your website always looks professional and is updated instantly, so you can focus entirely on your horses.",
            de: "Ich sorge für vollkommene Sorgenfreiheit in Ihrem Pferdegeschäft. Ihre Website wirkt stets professionell und wird sofort aktualisiert, damit Sie sich ganz auf Ihre Pferde konzentrieren können.",
            es: "Ofrezco total tranquilidad para su negocio equino. Me aseguro de que su sitio web siempre luzca profesional y se actualice al instante, para que pueda concentrarse completamente en sus caballos."
        },
        btn_membership: { en: "View Membership", de: "Mitgliedschaft ansehen", es: "Ver Membresía" },
        btn_contact: { en: "Get in Touch", de: "Kontakt aufnehmen", es: "Contactar" }
    },
    about: {
        title_prefix: { en: "Understanding the", de: "Verständnis der", es: "Entendiendo el" },
        title_highlight: { en: "Equestrian World", de: "Reitwelt", es: "Mundo Ecuestre" },
        paragraph1: {
            en: "My journey isn't just in code; it's in the paddock. With experience working alongside platforms like YardandGroom, I possess a unique understanding of the equestrian industry's specific needs.",
            de: "Meine Reise findet nicht nur im Code statt, sondern auch im Stall. Durch die Zusammenarbeit mit Plattformen wie YardandGroom besitze ich ein einzigartiges Verständnis für die Bedürfnisse der Pferdebranche.",
            es: "Mi viaje no es solo en código; es en el paddock. Con experiencia trabajando junto a plataformas como YardandGroom, poseo un entendimiento único de las necesidades específicas de la industria ecuestre."
        },
        paragraph2: {
            en: "You need a website that reflects the prestige of your stable and the quality of your stock. I build digital experiences that are as reliable as a good stable hand and as elegant as a dressage performance.",
            de: "Sie benötigen eine Website, die das Prestige Ihres Stalls und die Qualität Ihrer Pferde widerspiegelt. Ich entwickle digitale Erlebnisse, die so zuverlässig sind wie ein guter Stallbursche und so elegant wie eine Dressurvorstellung.",
            es: "Necesitas un sitio web que refleje el prestigio de tu establo y la calidad de tus ejemplares. Construyo experiencias digitales tan fiables como un buen mozo de cuadra y tan elegantes como una actuación de doma."
        },
        reliability: { en: "Reliability", de: "Zuverlässigkeit", es: "Fiabilidad" },
        support: { en: "Support", de: "Support", es: "Soporte" }
    },
    services: {
        subtitle: { en: "What I Provide", de: "Was ich biete", es: "Lo Que Ofrezco" },
        title: { en: "Comprehensive Management", de: "Umfassendes Management", es: "Gestión Integral" },
        description: {
            en: "I build, manage, and host your website so you don't have to. I am a reliable and caring team member who is always on your side, ensuring your site is updated quickly and effectively.",
            de: "Ich erstelle, verwalte und hoste Ihre Website, damit Sie es nicht müssen. Als verlässliches und engagiertes Teammitglied stehe ich immer an Ihrer Seite und sorge für schnelle und effektive Updates.",
            es: "Construyo, gestiono y alojo su sitio web. Soy un miembro del equipo fiable y atento que siempre está de su lado, asegurando actualizaciones rápidas y efectivas."
        },
        s1_title: { en: "Secure Hosting", de: "Sicheres Hosting", es: "Alojamiento Seguro" },
        s1_desc: {
            en: "Enterprise-grade hosting with SSL encryption. Your site remains fast, secure, and always online, protecting your client data.",
            de: "Hosting auf Unternehmensniveau mit SSL-Verschlüsselung. Ihre Website bleibt schnell, sicher und immer online.",
            es: "Alojamiento de nivel empresarial con encriptación SSL. Tu sitio permanece rápido, seguro y siempre en línea."
        },
        s2_title: { en: "Personal Access", de: "Persönlicher Zugang", es: "Acceso Personal" },
        s2_desc: {
            en: "Skip the help desk tickets. You get my personal mobile number for direct text/call access whenever you need updates.",
            de: "Vergessen Sie Helpdesks. Sie erhalten meine persönliche Handynummer für direkten Kontakt, wann immer Sie Updates benötigen.",
            es: "Olvídate de los tickets de soporte. Obtienes mi número de móvil personal para acceso directo por texto/llamada cuando necesites actualizaciones."
        },
        s3_title: { en: "Content Updates", de: "Inhalts-Updates", es: "Actualizaciones de Contenido" },
        s3_desc: {
            en: "New foal? Sale horse? Send me a photo and text, and I'll have it live on your site instantly. Effortless management.",
            de: "Neues Fohlen? Verkaufspferd? Schicken Sie mir ein Foto und Text, und es ist sofort online. Müheloses Management.",
            es: "¿Nuevo potro? ¿Caballo en venta? Envíame una foto y texto, y lo tendré en tu sitio al instante. Gestión sin esfuerzo."
        },
        s4_title: { en: "Lightning Fast", de: "Blitzschnelle Performance", es: "Velocidad del Rayo" },
        s4_desc: {
            en: "Zero bloat. Optimized for speed so your site loads instantly, even when you're out in the field with poor signal.",
            de: "Kein unnötiger Ballast. Optimiert für Geschwindigkeit, damit Ihre Seite sofort lädt – auch draußen auf dem Feld bei schlechtem Empfang.",
            es: "Sin código innecesario. Optimizado para velocidad, carga al instante incluso cuando estás en el campo con poca señal."
        }
    },
    portfolio: {
        subtitle: { en: "Previous Work", de: "Bisherige Arbeiten", es: "Trabajos Anteriores" },
        title: { en: "Example Projects", de: "Beispielprojekte", es: "Proyectos de Ejemplo" },
        description: {
            en: "See what's possible for your stable. High-end, responsive, and tailored to your brand.",
            de: "Sehen Sie, was für Ihren Stall möglich ist. High-End, reaktionsschnell und auf Ihre Marke zugeschnitten.",
            es: "Vea lo que es posible para su establo. De alta gama, adaptable y a medida de su marca."
        },
        placeholder_title: { en: "Your Stable Here", de: "Ihr Stall Hier", es: "Su Establo Aquí" },
        placeholder_desc: {
            en: "Ready to stand out? Let's build your digital legacy together.",
            de: "Bereit, herauszustechen? Lassen Sie uns gemeinsam Ihr digitales Erbe aufbauen.",
            es: "¿Listo para destacar? Construyamos juntos su legado digital."
        },
        sample_badge: { en: "Sample Site", de: "Beispielseite", es: "Sitio de Muestra" }
    },
    pricing: {
        title: { en: "All-Inclusive Web Partnership", de: "All-Inclusive Web-Partnerschaft", es: "Asociación Web Todo Incluido" },
        description: {
            en: "Simple, transparent pricing for a service that feels like having an in-house tech team.",
            de: "Einfache, transparente Preise für einen Service, der sich anfühlt wie ein internes Tech-Team.",
            es: "Precios simples y transparentes para un servicio que se siente como tener un equipo técnico interno."
        },
        check1: { en: "Expert Design & Build", de: "Experten-Design & Aufbau", es: "Diseño y Construcción Expertos" },
        check2: { en: "Hosting & Updates Included", de: "Hosting & Updates inklusive", es: "Alojamiento y Actualizaciones Incluidos" },
        check3: { en: "Direct Personal Support", de: "Direkter persönlicher Support", es: "Soporte Personal Directo" },
        card_tag: { en: "All-Inclusive", de: "All-Inclusive", es: "Todo Incluido" },
        card_title: { en: "Monthly Retainer", de: "Monatliches Honorar", es: "Retención Mensual" },
        per_month: { en: "per month", de: "pro Monat", es: "por mes" },
        feat_domain: { en: "Managed .com Domain Included", de: "Verwaltete .com Domain Inklusive", es: "Dominio .com Gestionado Incluido" },
        feat_hosting: { en: "Secure Cloud Hosting & SSL", de: "Sicheres Cloud-Hosting & SSL", es: "Alojamiento en la Nube y SSL" },
        feat_mobile: { en: "Mobile Optimised Design", de: "Für Mobilgeräte optimiertes Design", es: "Diseño Optimizado para Móviles" },
        feat_form: { en: "Visitor Contact Form", de: "Besucher-Kontaktformular", es: "Formulario de Contacto" },
        feat_updates: { en: "2 Hours Monthly Updates Included", de: "2 Stunden monatliche Updates inklusive", es: "2 Horas de Actualizaciones Mensuales Incluidas" },
        feat_support: { en: "Personal Mobile Number Access", de: "Zugang zur persönlichen Handynummer", es: "Acceso a Número Móvil Personal" },
        btn_start: { en: "Start Your Membership", de: "Mitgliedschaft starten", es: "Iniciar Membresía" },
        stripe_note: {
            en: "6-month minimum term. Secure payments via Stripe.",
            de: "6 Monate Mindestlaufzeit. Sichere Zahlung über Stripe.",
            es: "Plazo mínimo de 6 meses. Pagos seguros vía Stripe."
        },
        setup_fee: {
            en: "+ £250 One-Time Setup Fee",
            de: "+ 250 £ Einmalige Einrichtungsgebühr",
            es: "+ £250 Tarifa Única de Configuración"
        },
        custom_work_note: {
            en: "* Special bespoke features (e.g., blogs with comments) are not included and will incur an extra one-off cost.",
            de: "* Besondere maßgeschneiderte Funktionen (z. B. Blogs mit Kommentaren) sind nicht inbegriffen und verursachen zusätzliche einmalige Kosten.",
            es: "* Las características especiales a medida (por ejemplo, blogs con comentarios) no están incluidas y tendrán un costo extra único."
        }
    },
    faq: {
        subtitle: { en: "Common Questions", de: "Häufige Fragen", es: "Preguntas Comunes" },
        title: { en: "Frequently Asked Questions", de: "Häufig gestellte Fragen (FAQ)", es: "Preguntas Frecuentes" },
        q1: { en: "How does payment work?", de: "Wie funktioniert die Bezahlung?", es: "¿Cómo funciona el pago?" },
        a1: {
            en: "I use Stripe, the industry standard for secure online payments. You'll be billed £75 automatically each month. It's safe, encrypted, and hassle-free.",
            de: "Ich nutze Stripe, den Industriestandard für sichere Online-Zahlungen. Ihnen werden automatisch 75 £ pro Monat berechnet. Es ist sicher, verschlüsselt und unkompliziert.",
            es: "Uso Stripe, el estándar de la industria para pagos en línea seguros. Se te cobrarán £75 automáticamente cada mes. Es seguro, encriptado y sin complicaciones."
        },
        q2: { en: "Can I cancel or pause my subscription?", de: "Kann ich mein Abonnement kündigen oder pausieren?", es: "¿Puedo cancelar o pausar mi suscripción?" },
        a2: {
            en: "To keep monthly costs low, there is a 6-month minimum commitment. After that, you are free to cancel anytime with 30 days' notice.",
            de: "Um die monatlichen Kosten niedrig zu halten, gibt es eine Mindestbindung von 6 Monaten. Danach können Sie jederzeit mit einer Frist von 30 Tagen kündigen.",
            es: "Para mantener bajos los costos mensuales, hay un compromiso mínimo de 6 meses. Después de eso, puede cancelar en cualquier momento con 30 días de antelación."
        },
        q3: { en: "Do I own my domain name?", de: "Gehört mir mein Domainname?", es: "¿Soy dueño de mi nombre de dominio?" },
        a3: {
            en: "Yes! You always retain 100% ownership of your domain name (e.g., yourstables.com). I simply manage the technical side to keep it running smoothly.",
            de: "Ja! Sie behalten immer 100% Eigentum an Ihrem Domainnamen (z.B. ihrstall.de). Ich übernehme lediglich die technische Betreuung.",
            es: "¡Sí! Siempre conservas el 100% de la propiedad de tu nombre de dominio (ej. tusestablos.com). Yo me encargo de la gestión técnica para que todo funcione correctamente."
        },
        q4: { en: "How do I request updates?", de: "Wie fordere ich Updates an?", es: "¿Cómo solicito actualizaciones?" },
        a4: {
            en: "Once you're a member, you'll have my personal mobile number. Just text or WhatsApp me your photos and text updates, and I'll upload them for you.",
            de: "Als Mitglied haben Sie meine persönliche Handynummer. Schicken Sie mir einfach Ihre Fotos und Texte per WhatsApp, und ich lade sie für Sie hoch.",
            es: "Una vez que eres miembro, tendrás mi número de móvil personal. Solo envíame tus fotos y textos por WhatsApp, y yo los subiré por ti."
        },
        q5: { en: "Who am I?", de: "Wer bin ich?", es: "¿Quién soy?" },
        a5: {
            en: "I am a web developer who grew up in the countryside. I work directly with YardandGroom and understand the unique needs of stables and breeders. You get a trustworthy partner who is on your side in the digital arena.",
            de: "Ich bin Webentwickler und in der Reitwelt aufgewachsen. Ich arbeite direkt mit YardandGroom zusammen und verstehe die besonderen Bedürfnisse von Ställen und Züchtern. Sie erhalten einen vertrauenswürdigen Partner an Ihrer Seite.",
            es: "Soy desarrollador web y crecí en el mundo ecuestre. Trabajo directamente con YardandGroom y entiendo las necesidades únicas de establos y criadores. Obtienes un socio de confianza que está de tu lado."
        },
        q6: { en: "What languages do you support?", de: "Welche Sprachen unterstützen Sie?", es: "¿Qué idiomas soporta?" },
        a6: {
            en: "I build websites in any language. For personal communication, I speak English natively. For prompt replies in other languages, I recommend texting on WhatsApp. Calls are always welcome if you are an English speaker.",
            de: "Ich erstelle Websites in jeder Sprache. Persönlich spreche ich Englisch. Für schnelle Antworten in anderen Sprachen empfehle ich Textnachrichten über WhatsApp. Wenn Sie Englisch sprechen, rufe ich Sie gerne an.",
            es: "Construyo sitios web en cualquier idioma. Personalmente hablo inglés. Para respuestas rápidas en otros idiomas, recomiendo escribir por WhatsApp. Las llamadas son bienvenidas si habla inglés."
        },
        q7: { en: "Are there extra costs for custom features?", de: "Gibt es zusätzliche Kosten für benutzerdefinierte Funktionen?", es: "¿Hay costos adicionales por características personalizadas?" },
        a7: {
            en: "Yes. The monthly membership covers standard website design, hosting, and management. Complex features like blogs with comments, booking systems, or bespoke applications require significant extra development time and are billed as a one-time project fee.",
            de: "Ja. Die monatliche Mitgliedschaft deckt Standard-Webdesign, Hosting und Verwaltung ab. Komplexe Funktionen wie Blogs mit Kommentaren, Buchungssysteme oder maßgeschneiderte Anwendungen erfordern erhebliche zusätzliche Entwicklungszeit und werden als einmalige Projektgebühr abgerechnet.",
            es: "Sí. La membresía mensual cubre el diseño web estándar, alojamiento y gestión. Las características complejas como blogs con comentarios, sistemas de reserva o aplicaciones a medida requieren un tiempo de desarrollo adicional significativo y se facturan como una tarifa de proyecto única."
        }
    },
    contact: {
        title: { en: "Let's Discuss Your Vision", de: "Lassen Sie uns Ihre Vision besprechen", es: "Hablemos de Tu Visión" },
        description: {
            en: "Send me an email to let me know everything you need out of your new website, or if you just need to change site hosting or management. Once you join, you'll get my direct line for instant support.",
            de: "Senden Sie mir eine E-Mail, um mir mitzuteilen, was Sie für Ihre neue Website benötigen, oder ob Sie einfach nur das Hosting oder die Verwaltung wechseln möchten. Sobald Sie Mitglied sind, erhalten Sie meine Direktwahl für sofortigen Support.",
            es: "Envíame un correo para contarme lo que necesitas para tu nuevo sitio web, o si solo necesitas cambiar el alojamiento o la gestión. Una vez que te unas, obtendrás mi línea directa para soporte instantáneo."
        },
        members_only: { en: "Members Only Access", de: "Nur für Mitglieder", es: "Acceso Solo Miembros" },
        form_name: { en: "Your Name", de: "Ihr Name", es: "Tu Nombre" },
        form_email: { en: "Email Address", de: "E-Mail-Adresse", es: "Correo Electrónico" },
        form_message: { en: "How can I help you?", de: "Wie kann ich Ihnen helfen?", es: "¿Cómo puedo ayudarte?" },
        form_btn: { en: "Send Message", de: "Nachricht senden", es: "Enviar Mensaje" },
        form_sending: { en: "Sending...", de: "Senden...", es: "Enviando..." },
        form_success: { en: "Message sent successfully!", de: "Nachricht erfolgreich gesendet!", es: "¡Mensaje enviado con éxito!" },
        form_error: { en: "Error sending message. Please try again.", de: "Fehler beim Senden. Bitte versuchen Sie es erneut.", es: "Error al enviar mensaje. Por favor intente de nuevo." }
    },
    footer: {
        tagline: { en: "Premium Web Services for the Equestrian World.", de: "Premium Webservices für die Welt des Pferdesports.", es: "Servicios Web Premium para el Mundo Ecuestre." },
        rights: { en: "All Rights Reserved.", de: "Alle Rechte vorbehalten.", es: "Todos los derechos reservados." },
        terms_link: { en: "Service Terms", de: "AGB", es: "Términos del Servicio" }
    }
};

function changeLanguage(lang) {
    if (!['en', 'de', 'es'].includes(lang)) return;

    // Save preference
    localStorage.setItem('preferredLanguage', lang);

    // Update specific elements
    document.querySelectorAll('[data-i18n]').forEach(element => {
        const key = element.getAttribute('data-i18n');
        const keys = key.split('.'); // e.g., 'nav.about' -> ['nav', 'about']

        let valueObject = glossary;
        let validKey = true;

        // Traverse to the leaf node which contains the language mapped object
        for (const k of keys) {
            if (valueObject && valueObject[k]) {
                valueObject = valueObject[k];
            } else {
                validKey = false;
                break;
            }
        }

        if (validKey && valueObject && valueObject[lang]) {
            const translation = valueObject[lang];

            if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
                element.placeholder = translation;
            } else {
                element.innerText = translation;
            }
        }
    });

    // Update active state in dropdown
    document.querySelectorAll('.lang-btn').forEach(btn => {
        if (btn.dataset.lang === lang) {
            btn.classList.add('font-bold', 'text-equestrian-gold');
            btn.classList.add('bg-white/10');
        } else {
            btn.classList.remove('font-bold', 'text-equestrian-gold');
            btn.classList.remove('bg-white/10');
        }
    });
}

// Init
document.addEventListener('DOMContentLoaded', () => {
    // Initialize Lucide Icons if available
    if (typeof lucide !== 'undefined' && lucide.createIcons) {
        lucide.createIcons();
    }

    // 1. Check LocalStorage
    let initialLang = localStorage.getItem('preferredLanguage');

    // 2. If not in Storage, check Browser Language
    if (!initialLang) {
        const browserLang = navigator.language.slice(0, 2); // e.g. 'en-US' -> 'en'
        if (['en', 'de', 'es'].includes(browserLang)) {
            initialLang = browserLang;
        }
    }

    // 3. Default to English
    changeLanguage(initialLang || 'en');
});
