const glossary = {
    nav: {
        about: { en: "About", de: "Über Mich", es: "Sobre Mí" },
        services: { en: "Services", de: "Dienstleistungen", es: "Servicios" },
        membership: { en: "Membership", de: "Mitgliedschaft", es: "Membresía" },
        contact: { en: "Contact Me", de: "Kontakt", es: "Contacto" }
    },
    hero: {
        subtitle: { en: "Digital Excellence for Equestrians", de: "Digitale Exzellenz für den Reitsport", es: "Excelencia Digital para Ecuestres" },
        title_prefix: { en: "Elevate Your", de: "Stärken Sie Ihr", es: "Eleva Tu" },
        title_highlight: { en: "Equine Business", de: "Pferdegeschäft", es: "Negocio Equino" },
        description: {
            en: "Premium web management for stables, breeders, and trainers. Dedicated support for those who demand excellence.",
            de: "Premium-Webmanagement für Ställe, Züchter und Trainer. Dedizierter Support für alle, die Exzellenz verlangen.",
            es: "Gestión web premium para establos, criadores y entrenadores. Soporte dedicado para aquellos que exigen excelencia."
        },
        btn_membership: { en: "View Membership", de: "Mitgliedschaft ansehen", es: "Ver Membresía" },
        btn_contact: { en: "Get in Touch", de: "Kontakt aufnehmen", es: "Contactar" }
    },
    about: {
        title_prefix: { en: "Understanding the", de: "Verständnis der", es: "Entendiendo el" },
        title_highlight: { en: "Equestrian World", de: "Reitwelt", es: "Mundo Ecuestre" },
        paragraph1: {
            en: "My journey isn't just in code; it's in the paddock. With experience working alongside platforms like YardandGroom, I possess a unique understanding of the equestrian industry's specific needs.",
            de: "Meine Reise findet nicht nur im Code statt, sondern auch im Stall. Durch die Zusammenarbeit mit Plattformen wie YardandGroom besitze ich ein einzigartiges Verständnis für die Bedürfnisse der Pferdebranche.",
            es: "Mi viaje no es solo en código; es en el paddock. Con experiencia trabajando junto a plataformas como YardandGroom, poseo un entendimiento único de las necesidades específicas de la industria ecuestre."
        },
        paragraph2: {
            en: "You need a website that reflects the prestige of your stable and the quality of your stock. I build digital experiences that are as reliable as a good stable hand and as elegant as a dressage performance.",
            de: "Sie benötigen eine Website, die das Prestige Ihres Stalls und die Qualität Ihrer Pferde widerspiegelt. Ich entwickle digitale Erlebnisse, die so zuverlässig sind wie ein guter Stallbursche und so elegant wie eine Dressurvorstellung.",
            es: "Necesitas un sitio web que refleje el prestigio de tu establo y la calidad de tus ejemplares. Construyo experiencias digitales tan fiables como un buen mozo de cuadra y tan elegantes como una actuación de doma."
        },
        reliability: { en: "Reliability", de: "Zuverlässigkeit", es: "Fiabilidad" },
        support: { en: "Support", de: "Support", es: "Soporte" }
    },
    services: {
        subtitle: { en: "What I Provide", de: "Was ich biete", es: "Lo Que Ofrezco" },
        title: { en: "Comprehensive Management", de: "Umfassendes Management", es: "Gestión Integral" },
        description: {
            en: "Focus on your horses while I handle the entire digital side of your business. Seamless, professional, and always available.",
            de: "Konzentrieren Sie sich auf Ihre Pferde, während ich mich um die gesamte digitale Seite Ihres Unternehmens kümmere. Nahtlos, professionell und immer verfügbar.",
            es: "Concéntrate en tus caballos mientras yo manejo todo el lado digital de tu negocio. Sin problemas, profesional y siempre disponible."
        },
        s1_title: { en: "Secure Hosting", de: "Sicheres Hosting", es: "Alojamiento Seguro" },
        s1_desc: {
            en: "Enterprise-grade hosting with SSL encryption. Your site remains fast, secure, and always online, protecting your client data.",
            de: "Hosting auf Unternehmensniveau mit SSL-Verschlüsselung. Ihre Website bleibt schnell, sicher und immer online.",
            es: "Alojamiento de nivel empresarial con encriptación SSL. Tu sitio permanece rápido, seguro y siempre en línea."
        },
        s2_title: { en: "Personal Access", de: "Persönlicher Zugang", es: "Acceso Personal" },
        s2_desc: {
            en: "Skip the help desk tickets. You get my personal mobile number for direct text/call access whenever you need updates.",
            de: "Vergessen Sie Helpdesks. Sie erhalten meine persönliche Handynummer für direkten Kontakt, wann immer Sie Updates benötigen.",
            es: "Olvídate de los tickets de soporte. Obtienes mi número de móvil personal para acceso directo por texto/llamada cuando necesites actualizaciones."
        },
        s3_title: { en: "Content Updates", de: "Inhalts-Updates", es: "Actualizaciones de Contenido" },
        s3_desc: {
            en: "New foal? Sale horse? Send me a photo and text, and I'll have it live on your site instantly. Effortless management.",
            de: "Neues Fohlen? Verkaufspferd? Schicken Sie mir ein Foto und Text, und es ist sofort online. Müheloses Management.",
            es: "¿Nuevo potro? ¿Caballo en venta? Envíame una foto y texto, y lo tendré en tu sitio al instante. Gestión sin esfuerzo."
        }
    },
    pricing: {
        title: { en: "Concierge Web Services", de: "Concierge Webservices", es: "Servicios Web de Conserjería" },
        description: {
            en: "Simple, transparent pricing for a service that feels like having an in-house tech team.",
            de: "Einfache, transparente Preise für einen Service, der sich anfühlt wie ein internes Tech-Team.",
            es: "Precios simples y transparentes para un servicio que se siente como tener un equipo técnico interno."
        },
        check1: { en: "No Setup Fees", de: "Keine Einrichtungsgebühren", es: "Sin tarifas de configuración" },
        check2: { en: "Cancel Anytime", de: "Jederzeit kündbar", es: "Cancela cuando quieras" },
        check3: { en: "Personal Relationship", de: "Persönliche Beziehung", es: "Relación personal" },
        card_tag: { en: "All-Inclusive", de: "All-Inclusive", es: "Todo Incluido" },
        card_title: { en: "Monthly Retainer", de: "Monatliches Honorar", es: "Retención Mensual" },
        per_month: { en: "per month", de: "pro Monat", es: "por mes" },
        feat1: { en: "Complete Website Management", de: "Komplettes Website-Management", es: "Gestión completa del sitio web" },
        feat2: { en: "Personal Mobile Number Access", de: "Zugang zur persönlichen Handynummer", es: "Acceso a número móvil personal" },
        feat3: { en: "Unlimited Content Updates", de: "Unbegrenzte Inhalts-Updates", es: "Actualizaciones de contenido ilimitadas" },
        feat4: { en: "Design & Hosting Included", de: "Design & Hosting inklusive", es: "Diseño y alojamiento incluidos" },
        btn_start: { en: "Start Your Membership", de: "Mitgliedschaft starten", es: "Iniciar Membresía" },
        stripe_note: {
            en: "Payments processed securely via Stripe. Pause or cancel anytime.",
            de: "Zahlungen sicher über Stripe. Abonnement jederzeit pausieren oder kündigen.",
            es: "Pagos procesados de forma segura vía Stripe. Pausa o cancela tu suscripción en cualquier momento."
        }
    },
    faq: {
        subtitle: { en: "Common Questions", de: "Häufige Fragen", es: "Preguntas Comunes" },
        title: { en: "Frequently Asked Questions", de: "Häufig gestellte Fragen (FAQ)", es: "Preguntas Frecuentes" },
        q1: { en: "How does payment work?", de: "Wie funktioniert die Bezahlung?", es: "¿Cómo funciona el pago?" },
        a1: {
            en: "We use Stripe, the industry standard for secure online payments. You'll be billed £75 automatically each month. It's safe, encrypted, and hassle-free.",
            de: "Wir nutzen Stripe, den Industriestandard für sichere Online-Zahlungen. Ihnen werden automatisch 75 £ pro Monat berechnet. Es ist sicher, verschlüsselt und unkompliziert.",
            es: "Usamos Stripe, el estándar de la industria para pagos en línea seguros. Se te cobrarán £75 automáticamente cada mes. Es seguro, encriptado y sin complicaciones."
        },
        q2: { en: "Can I cancel or pause my subscription?", de: "Kann ich mein Abonnement kündigen oder pausieren?", es: "¿Puedo cancelar o pausar mi suscripción?" },
        a2: {
            en: "Absolutely. You are never locked in. You can pause your membership during the off-season or cancel anytime with a single click in your portal. No questions asked.",
            de: "Absolut. Sie sind niemals gebunden. Sie können Ihre Mitgliedschaft außerhalb der Saison pausieren oder jederzeit mit einem Klick kündigen.",
            es: "Absolutamente. Nunca estás atado. Puedes pausar tu membresía durante la temporada baja o cancelar en cualquier momento con un solo clic."
        },
        q3: { en: "Do I own my domain name?", de: "Gehört mir mein Domainname?", es: "¿Soy dueño de mi nombre de dominio?" },
        a3: {
            en: "Yes! You always retain 100% ownership of your domain name (e.g., yourstables.com). I simply manage the technical side to keep it running smoothly.",
            de: "Ja! Sie behalten immer 100% Eigentum an Ihrem Domainnamen (z.B. ihrstall.de). Ich kümmere mich nur um die Technik.",
            es: "¡Sí! Siempre conservas el 100% de la propiedad de tu nombre de dominio (ej. tusestablos.com). Yo simplemente gestiono el lado técnico."
        },
        q4: { en: "How do I request updates?", de: "Wie fordere ich Updates an?", es: "¿Cómo solicito actualizaciones?" },
        a4: {
            en: "Once you're a member, you'll have my personal mobile number. Just text or WhatsApp me your photos and text updates, and I'll upload them for you.",
            de: "Als Mitglied haben Sie meine persönliche Handynummer. Schicken Sie mir einfach Ihre Fotos und Texte per WhatsApp, und ich lade sie für Sie hoch.",
            es: "Una vez que eres miembro, tendrás mi número de móvil personal. Solo envíame tus fotos y textos por WhatsApp, y yo los subiré por ti."
        }
    },
    contact: {
        title: { en: "Let's Discuss Your Vision", de: "Lassen Sie uns Ihre Vision besprechen", es: "Hablemos de Tu Visión" },
        description: {
            en: "Ready to upgrade your online presence? Send me an email to get started. Once you join, you'll get my direct line for instant support.",
            de: "Bereit, Ihre Online-Präsenz zu verbessern? Senden Sie mir eine E-Mail, um zu beginnen. Sobald Sie Mitglied sind, erhalten Sie meine Direktwahl für sofortigen Support.",
            es: "¿Listo para mejorar tu presencia en línea? Envíame un correo para comenzar. Una vez que te unas, obtendrás mi línea directa para soporte instantáneo."
        },
        members_only: { en: "Members Only Access", de: "Nur für Mitglieder", es: "Acceso Solo Miembros" }
    },
    footer: {
        tagline: { en: "Premium Web Services for the Equestrian World.", de: "Premium Webservices für die Welt des Pferdesports.", es: "Servicios Web Premium para el Mundo Ecuestre." },
        rights: { en: "All Rights Reserved.", de: "Alle Rechte vorbehalten.", es: "Todos los derechos reservados." }
    }
};

function changeLanguage(lang) {
    if (!['en', 'de', 'es'].includes(lang)) return;

    // Save preference
    localStorage.setItem('preferredLanguage', lang);

    // Update specific elements
    document.querySelectorAll('[data-i18n]').forEach(element => {
        const key = element.getAttribute('data-i18n');
        const keys = key.split('.'); // e.g., 'nav.about' -> ['nav', 'about']

        let valueObject = glossary;
        let validKey = true;

        // Traverse to the leaf node which contains the language mapped object
        for (const k of keys) {
            if (valueObject && valueObject[k]) {
                valueObject = valueObject[k];
            } else {
                validKey = false;
                break;
            }
        }

        if (validKey && valueObject && valueObject[lang]) {
            const translation = valueObject[lang];

            if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
                element.placeholder = translation;
            } else {
                element.innerText = translation;
            }
        }
    });

    // Update active state in dropdown
    document.querySelectorAll('.lang-btn').forEach(btn => {
        if (btn.dataset.lang === lang) {
            btn.classList.add('font-bold', 'text-equestrian-gold');
            btn.classList.add('bg-white/10');
        } else {
            btn.classList.remove('font-bold', 'text-equestrian-gold');
            btn.classList.remove('bg-white/10');
        }
    });
}

// Init
document.addEventListener('DOMContentLoaded', () => {
    // 1. Check LocalStorage
    let initialLang = localStorage.getItem('preferredLanguage');

    // 2. If not in Storage, check Browser Language
    if (!initialLang) {
        const browserLang = navigator.language.slice(0, 2); // e.g. 'en-US' -> 'en'
        if (['en', 'de', 'es'].includes(browserLang)) {
            initialLang = browserLang;
        }
    }

    // 3. Default to English
    changeLanguage(initialLang || 'en');
});
